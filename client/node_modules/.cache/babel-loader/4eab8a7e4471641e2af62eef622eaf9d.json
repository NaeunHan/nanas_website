{"ast":null,"code":"import _regeneratorRuntime from\"/Users/baejunho/Desktop/nanas_homepage/nanas-shoppingMall/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/baejunho/Desktop/nanas_homepage/nanas-shoppingMall/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/baejunho/Desktop/nanas_homepage/nanas-shoppingMall/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import axios from\"axios\";import React,{useEffect,useState}from\"react\";import{useNavigate,useSearchParams}from\"react-router-dom\";import{HiArrowCircleDown}from\"react-icons/hi\";import classes from\"./ProductCategoryList.module.css\";import ProductCategoryListDetail from\"./ProductCategoryListDetail\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var ProductCategoryList=function ProductCategoryList(_ref){var title=_ref.title,type=_ref.type,setProducts=_ref.setProducts;var navigate=useNavigate();var _useSearchParams=useSearchParams(),_useSearchParams2=_slicedToArray(_useSearchParams,1),searchParams=_useSearchParams2[0];var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isShown=_useState2[0],setIsShown=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),category3=_useState4[0],setCategory3=_useState4[1];var subtitle=searchParams.get(\"type2\");// ✅ URL 변경될 때만 fetch\nuseEffect(function(){if(!subtitle)return;var fetchData=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var res;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return axios.get(\"http://localhost:5000/product/api/get/products/subcategory?type2=\".concat(subtitle));case 3:res=_context.sent;setCategory3(res.data.category3);setProducts(res.data.products);_context.next=13;break;case 8:_context.prev=8;_context.t0=_context[\"catch\"](0);console.error(_context.t0);setCategory3([]);setProducts([]);case 13:case\"end\":return _context.stop();}}},_callee,null,[[0,8]]);}));return function fetchData(){return _ref2.apply(this,arguments);};}();fetchData();},[subtitle,setProducts]);var handleSubtitle=function handleSubtitle(){setIsShown(function(prev){return!prev;});navigate(\"/categories?type=\".concat(type,\"&type2=\").concat(title));};return/*#__PURE__*/_jsxs(\"ul\",{className:classes[\"productsCategory-categoryList-wrap\"],children:[/*#__PURE__*/_jsxs(\"div\",{className:classes[\"productsCategory-categoryList\"],onClick:handleSubtitle,children:[title,\" \",/*#__PURE__*/_jsx(HiArrowCircleDown,{})]}),isShown&&/*#__PURE__*/_jsx(\"div\",{className:classes[\"productsCategory-categoryList-items\"],children:category3.map(function(it){return/*#__PURE__*/_jsx(ProductCategoryListDetail,{title:it.category3,type:type,subtitle:subtitle,setProducts:setProducts},it.category3);})})]});};export default ProductCategoryList;","map":{"version":3,"names":["axios","React","useEffect","useState","useNavigate","useSearchParams","HiArrowCircleDown","classes","ProductCategoryListDetail","ProductCategoryList","title","type","setProducts","navigate","searchParams","isShown","setIsShown","category3","setCategory3","subtitle","get","fetchData","res","data","products","console","error","handleSubtitle","prev","map","it"],"sources":["/Users/baejunho/Desktop/nanas_homepage/nanas-shoppingMall/client/src/components/pages/productsCategory/ProductCategoryList.jsx"],"sourcesContent":["import axios from \"axios\";\nimport React, { useEffect, useState } from \"react\";\nimport { useNavigate, useSearchParams } from \"react-router-dom\";\nimport { HiArrowCircleDown } from \"react-icons/hi\";\n\nimport classes from \"./ProductCategoryList.module.css\";\nimport ProductCategoryListDetail from \"./ProductCategoryListDetail\";\n\nconst ProductCategoryList = ({ title, type, setProducts }) => {\n  const navigate = useNavigate();\n  const [searchParams] = useSearchParams();\n\n  const [isShown, setIsShown] = useState(false);\n  const [category3, setCategory3] = useState([]);\n\n  const subtitle = searchParams.get(\"type2\");\n\n  // ✅ URL 변경될 때만 fetch\n  useEffect(() => {\n    if (!subtitle) return;\n\n    const fetchData = async () => {\n      try {\n        const res = await axios.get(\n          `http://localhost:5000/product/api/get/products/subcategory?type2=${subtitle}`\n        );\n        setCategory3(res.data.category3);\n        setProducts(res.data.products);\n      } catch (e) {\n        console.error(e);\n        setCategory3([]);\n        setProducts([]);\n      }\n    };\n\n    fetchData();\n  }, [subtitle, setProducts]);\n\n  const handleSubtitle = () => {\n    setIsShown((prev) => !prev);\n    navigate(`/categories?type=${type}&type2=${title}`);\n  };\n\n  return (\n    <ul className={classes[\"productsCategory-categoryList-wrap\"]}>\n      <div\n        className={classes[\"productsCategory-categoryList\"]}\n        onClick={handleSubtitle}\n      >\n        {title} <HiArrowCircleDown />\n      </div>\n\n      {isShown && (\n        <div className={classes[\"productsCategory-categoryList-items\"]}>\n          {category3.map((it) => (\n            <ProductCategoryListDetail\n              key={it.category3}\n              title={it.category3}\n              type={type}\n              subtitle={subtitle}\n              setProducts={setProducts}\n            />\n          ))}\n        </div>\n      )}\n    </ul>\n  );\n};\n\nexport default ProductCategoryList;\n"],"mappings":"kdAAA,MAAOA,MAAK,KAAM,OAAO,CACzB,MAAOC,MAAK,EAAIC,SAAS,CAAEC,QAAQ,KAAQ,OAAO,CAClD,OAASC,WAAW,CAAEC,eAAe,KAAQ,kBAAkB,CAC/D,OAASC,iBAAiB,KAAQ,gBAAgB,CAElD,MAAOC,QAAO,KAAM,kCAAkC,CACtD,MAAOC,0BAAyB,KAAM,6BAA6B,CAAC,wFAEpE,GAAMC,oBAAmB,CAAG,QAAtBA,oBAAmB,MAAqC,IAA/BC,MAAK,MAALA,KAAK,CAAEC,IAAI,MAAJA,IAAI,CAAEC,WAAW,MAAXA,WAAW,CACrD,GAAMC,SAAQ,CAAGT,WAAW,EAAE,CAC9B,qBAAuBC,eAAe,EAAE,sDAAjCS,YAAY,sBAEnB,cAA8BX,QAAQ,CAAC,KAAK,CAAC,wCAAtCY,OAAO,eAAEC,UAAU,eAC1B,eAAkCb,QAAQ,CAAC,EAAE,CAAC,yCAAvCc,SAAS,eAAEC,YAAY,eAE9B,GAAMC,SAAQ,CAAGL,YAAY,CAACM,GAAG,CAAC,OAAO,CAAC,CAE1C;AACAlB,SAAS,CAAC,UAAM,CACd,GAAI,CAACiB,QAAQ,CAAE,OAEf,GAAME,UAAS,6FAAG,mLAEIrB,MAAK,CAACoB,GAAG,4EAC2CD,QAAQ,EAC7E,QAFKG,GAAG,eAGTJ,YAAY,CAACI,GAAG,CAACC,IAAI,CAACN,SAAS,CAAC,CAChCL,WAAW,CAACU,GAAG,CAACC,IAAI,CAACC,QAAQ,CAAC,CAAC,+EAE/BC,OAAO,CAACC,KAAK,aAAG,CAChBR,YAAY,CAAC,EAAE,CAAC,CAChBN,WAAW,CAAC,EAAE,CAAC,CAAC,oEAEnB,kBAZKS,UAAS,2CAYd,CAEDA,SAAS,EAAE,CACb,CAAC,CAAE,CAACF,QAAQ,CAAEP,WAAW,CAAC,CAAC,CAE3B,GAAMe,eAAc,CAAG,QAAjBA,eAAc,EAAS,CAC3BX,UAAU,CAAC,SAACY,IAAI,QAAK,CAACA,IAAI,GAAC,CAC3Bf,QAAQ,4BAAqBF,IAAI,mBAAUD,KAAK,EAAG,CACrD,CAAC,CAED,mBACE,YAAI,SAAS,CAAEH,OAAO,CAAC,oCAAoC,CAAE,wBAC3D,aACE,SAAS,CAAEA,OAAO,CAAC,+BAA+B,CAAE,CACpD,OAAO,CAAEoB,cAAe,WAEvBjB,KAAK,kBAAE,KAAC,iBAAiB,IAAG,GACzB,CAELK,OAAO,eACN,YAAK,SAAS,CAAER,OAAO,CAAC,qCAAqC,CAAE,UAC5DU,SAAS,CAACY,GAAG,CAAC,SAACC,EAAE,qBAChB,KAAC,yBAAyB,EAExB,KAAK,CAAEA,EAAE,CAACb,SAAU,CACpB,IAAI,CAAEN,IAAK,CACX,QAAQ,CAAEQ,QAAS,CACnB,WAAW,CAAEP,WAAY,EAJpBkB,EAAE,CAACb,SAAS,CAKjB,EACH,CAAC,EAEL,GACE,CAET,CAAC,CAED,cAAeR,oBAAmB"},"metadata":{},"sourceType":"module"}